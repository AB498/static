<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            preflight: false
        }
    </script>
</head>

<body class="bg-black text-white">

    <input type="file" multiple name="filename" id="uploader">
    <button>Upload</button>

    <div class="resp font-mono whitespace-pre-wrap"></div>
    <script>

        uploaderEl = document.getElementById("uploader");
        uploaderEl.onchange = function () {
            console.log(this.files[0])
        }

        document.querySelector("button").addEventListener("click", async function () {
            formData = new FormData();
            [...uploaderEl.files].forEach(file => {
                formData.append("file", file);
            })
            formData.append("bodyString", JSON.stringify({ template: "uk_dl.docx", stringMap: { "name": "John Doe" }, "imageMap": { 0: 0 } }));

            let res;
            try {

                res = (await fetch("https://ab498.pythonanywhere.com/generateid", {
                    method: "POST",
                    body: formData
                }));
                res = await res.text();
                res = JSON.parse(res);
                console.log(res)
            } catch (error) {
                console.log(error, res)
            }
            document.querySelector(".resp").innerHTML = typeof res == "string" ? res : JSON.stringify(res, null, 2);
        })
    </script>
</body>

</html>